
\newpage
# ダメな脳波解析集
こんにちは。脳波解析に拘る怖いおじさんだよ！
本書を読んだ君には悪い脳科学者にならないでほしいです。
なので、悪い落し穴を思いつくかぎり列挙します。

## コネクティビティ計算でPLVを使う

PLVは波形解析によってある地点とある地点に
コネクティビティがあるかどうかを調べる指標で、
脳波解析の文脈で広く使われるものです。

...いや、広く使われていたものです。
**この指標は理由がない限り因果関係の考察に使わないで下さい。**

### PLVの計算方法
フーリエ変換とかWavelet変換では位相の情報が出てきます。
その為、波形同士の相関を計算することが可能になります。素敵ですね！
Wavelet変換で計算した二つの波の複素数のノルムを1に補正したものを掛け合わせて、
互いに足し合わせて平均をとれば、特定の周波数に関して
どの程度似ているか分かります。
ここで、波xとyの相関関数をSxyとすると下記の式になります。

$$E{\frac{Sxy}{|Sxy|}}$$

二つの波が同時に高くなったり低くなるなら、波同士は相関があります。
**もし、相関具合が高ければ、因果関係がある…君はそう思ったかい？
それは間違いだ！**

相関と因果を間違ってはいけないのです。

### 問
今京都で地震が起こったとします。
東京と福岡にその地震が波及してきました。
さて、京都と東京と福岡、どの場所に因果関係があるでしょうか？
- 京都→東京
- 京都→福岡

ってなるだろ…常識的に考えて。

だけど、PLVだと東京と福岡が最も強く相関する、と出ます。
何故でしょうか？

### 回答例
京都から東京に波が波及するときに時間がかかります。
つまり、京都と東京は位相がずれています。
一方、東京と福岡は同じくらいずれています。

PLV「京都だけ位相が遅れていない。
京都は仲間はずれだ！東京と福岡は同じくらい遅れている。
だから東京と福岡には関係がある。京都の地震は東京や福岡の地震とは無関係だ！！！」

PLVでは東京と福岡に相関が高いため、東京と福岡を関連づけて考えるのです。
PLVは特殊なケースでしか使ってはいけません。


## Wavelet変換の結果を隅々まで使う
Wavelet変換は波の端に弱いです。
というのは、波の終端は0や波の始まりで埋められています。
そこには落差があるはずです。
落差は全ての周波数を含むものであり、これを回避する方法はありません。
窓関数を使うと波は変形されてしまいます。
Wavelet変換は長い波に適用しておいて、端から遠い所を使うようにしましょう。

## フーリエ変換で窓関数を使わない
フーリエ変換ではWavelet変換よりも酷い事がおきます。
フーリエ変換は時間成分が消失するため、上記の端の問題が
波形全体にでてきます。フーリエ変換では窓関数は必須です。
窓関数とは、端を消すための関数です。つまり、波を改変してしまいます。
嫌ですねぇ。仕方ないんですけれどね…。

## ICAの前にband pass filterをしない
ICAは低周波数の影響が大きいです。
ICAをする時はband pass filterを事前に必ずしておきましょう。

## センサーのコネクティビティでラプラシアンしない
センサー間のコネクティビティをする時にはラプラシアンを計算する
必要があります。
そうじゃなければソース推定をする必要があります。

## 脳波を純粋な指標と考える
脳波は様々な活動の合算です。
例えば、貴方が「コーラの味を表す脳波を測定したい」とします。
何がおこるでしょうか？
まず、コーラを飲むために、下記の脳活動がおこります。

- コップを持つための運動野
- 手が震えないための小脳
- コーラを見ないとこぼすので、視覚野
- コーラをコーラとわかるための海馬
- コーラの匂いを感じる嗅覚野
- コーラの泡が弾ける音、聴覚野
- コーラを嚥下する為の。。。

お前！あまりに多すぎて挙げるのがダルくなってきたじゃないか！
多分、これの3倍くらいは挙げられると思うよ。
君はどうしてコーラの味を脳波で測れると思ったのかい？
それをするためには、ファンタと比べると良いと思うじゃん？
ダメです！味だけファンタにして、色や匂いはコーラに
合せなきゃいけないのです！

AIにはハルシネーションがあるから間違いはすぐわかります。
しかし、脳波は計算できてしまう。貴方は慎重であるべきです。

# ジッターがある実験で高周波の位相を測定する
ジッターがある実験では位相について語ってはいけません。
例えば、80Hzの脳波で位相を語る場合、1msのジッターでは
28.8度の位相ジッターとなります。これは酷いですね。
1msのジッターって結構たいへんなのです。
powerやコネクティビティであればマシなのですが、
位相は実験環境をきちんと整備しなければ無理な実験です。

